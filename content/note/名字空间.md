---
title: 名字空间
author: Xin Lu
date: '2023-05-04'
slug: []
categories: []
tags: []

---



与 **作用域** 相对应， *Python* 在运行时借助 *dict* 对象保存作用域中的名字，构成动态的 **名字空间** 。这样的名字空间总共有 *4* 个：

- 内建名字空间
- 全局名字空间
- 闭包名字空间
- 局部名字空间

*Python* 语句在查找名字时，按照 *Local* *Enclosing* *Global* *Builtin* 这样的顺序在 *4* 个名字空间中查找，这也就是所谓的 **LEGB** 规则。

## 名字空间

**作用域** 是语法层面的概念，是静态的。当程序开始执行后，作用域中的名字绑定关系需要存储在某个地方，这个地方就是 **名字空间** 。由于名字绑定关系是有 **名字** 和 **对象** 组成的键值对，因而 *dict* 对象是理想的存储容器。

### Globals

在 *Python* 中，每个 **模块** 背后都有一个 *dict* 对象，用于存储 **全局作用域** 中的名字，这就是 **全局名字空间** ( *Globals* )。

- 模块的 **属性空间** 以及 **全局名字空间** 是同一个东西，都藏身于同一个 *dict* 对象。

### Locals

*Python* 执行一个作用域内的代码时，需要一个容器来存储当前作用域内的名字，这就是 **局部名字空间** ( *Locals* )。

代码语句中涉及的名字查找，均在这个两个名字空间中进行：先查找局部名字空间，再查找全局名字空间。

### Enclosings

在作用域存在嵌套的情况下， *Python* 将内层代码块中依赖的所有外层名字存储在一个容器内，这就是 **闭包名字空间** ( *Enclosings* )。

### Builtin

*Python* 在 *builtin* 模块中提供了很多内建函数和类型，构成运行时的另一个名字空间 **内建名字空间** ( *Builtin* )。像 *print* 这样的内建函数或类型，均需要在这个名字空间中查找：

全局名字空间中有一个名字指向内建名字空间：



>>> import builtins
>>> circle.__builtins__ is builtins.__dict__
>>> True  

当我们往 *dict* 对象中添加名字 *name* 后，属性查找便成功了：

>>> a.__dict__['name'] = 'tom'
>>> a.name
>>> 'tom'